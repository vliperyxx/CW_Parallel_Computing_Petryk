# Пошуковий веб-сервіс

Даний проект є реалізацією системи пошуку інформації на основі інвертованого індексу. Він складається з багатопоточного C++ сервера, консольного С++ клієнта та веб-інтерфейсу.

## Попередні вимоги та підготовка

Перед початком роботи  треба переконатись, що на вашому комп'ютері встановлено наступне програмне забезпечення. Якщо ні, потрібно встановити:

  * **Git.** Система контролю версій для клонування репозиторію. Встановлюється з допомогою наступної команди:

    ```powershell
    winget install --id Git.Git -e --source winget
    ```

    Для перевірки, чи встановлення пройшло успішно, введіть в терміналі `git --version`.

  * **Компілятор C+.** Потрібен компілятор з підтримкою стандарту C++20, рекомендується використати MSYS2. Якщо він не встановлений це можна зробити за посиланням [https://www.msys2.org/](https://www.msys2.org/).
    Після його встановлення відкрийте термінал саме MSYS2 UCRT64 і оновіть базу пакетів командою:

    ```bash
    pacman -S mingw-w64-ucrt-x86_64-toolchain
    ```

    Якщо термінал закриється після оновлення, все нормально, відкрийте його знову. Після цього встановіть набір інструментів:

    ```bash
    pacman -S mingw-w64-ucrt-x86_64-toolchain mingw-w64-ucrt-x86_64-cmake mingw-w64-ucrt-x86_64-make
    ```

    Натисніть Enter, щоб вибрати всі компоненти групи, а потім Y щоб почати встановлення. Врешті перевірте, чи все було завантажено успішно:

    ```bash
    ls /ucrt64/bin/g++.exe
    ```

    Також обовязково додайте шлях `C:\msys64\ucrt64\bin` до системних змінних середовища (Path) Windows, щоб команди працювали у звичайній консолі.

  * **CMake** (версія 3.20 або вище). Система для автоматизації збірки проєкту. Для встановлення треба ввести команду:

    ```powershell
    winget install Kitware.CMake
    ```

    Для перевірки чи встановлення пройшло успішно введіть `cmake --version`.

### 1\. Завантаження проєкту

Відкрийте термінал та виконайте команду для клонування репозиторію в зручну для вас папку:

```bash
git clone https://github.com/vliperyxx/CW_Parallel_Computing_Petryk.git
cd CW_Parallel_Computing_Petryk
```

### 2\. Підготовка даних

Переконайтеся, що в папці `server/data` є всі текстові файли, по яким буде здійснюватися пошук, і ця папка не порожня.

## Запуск С++ сервера та консольного клієнта

Проект використовує CMake для збірки, тому обовязково переконайтесь, що він у вас завантажений.

### Збірка проєкту

Створіть папку для збірки та перейдіть у неї:

```bash
mkdir cmake-build-release
cd cmake-build-release
```

Згенеруйте файли збірки та скомпілюйте проект:

```bash
cmake -G "MinGW Makefiles" -DCMAKE_MAKE_PROGRAM="C:\msys64\ucrt64\bin\mingw32-make.exe" -D CMAKE_BUILD_TYPE=Release ..
cmake --build .
```

Після успішної компіляції у цій папці повинні зявитись файли `Server.exe` та `Client.exe`.

### Запуск сервера

Щоб запустити сервер, відкрийте термінал у папці `cmake-build-release` і запустіть сервер:

```bash
./Server.exe
```

Сервер почне індексацію файлів, але перед тим як запустити клієнта дочекайтеся повідомлення "Server started listening on port 8080".

### Запуск консольного клієнта

Відкрийте ше одне вікно терміналу, перейдіть у ту ж папку і виконайте:

```bash
./Client.exe
```

Після цього ви можете вводити пошукові запити в консолі.

## Запуск веб-клієнта

Для роботи веб-інтерфейсу перш за все потрібен Node.js, який можна встановити з офіційного сайту [https://nodejs.org/en/download/](https://nodejs.org/en/download/).

Після встановлення відкрийте термінал у кореневій папці проекту та перейдіть до папки з веб-клієнтом:

```bash
cd web-client
```

Встановіть необхідні бібліотеки, а саме Parcel, Express, CORS, з допомогою команди нижче:

```bash
npm install
```

### Запуск проксі-сервера та сайту

Для запуску вам треба буде два термінали. В першому терміналі з тієї ж папки `web-client` запустіть проксі-сервер, який з'єднає браузер з C++ сервером:

```bash
npm run proxy
```

Ви повинні побачити повідомлення "Proxy listening on http://localhost:3000".

В другому терміналі  теж з папки `web-client` запустіть вже сам веб-інтерфейс:

```bash
npm start
```

Parcel сам відкриє ваш браузер за адресою http://localhost:1234, або можете перейти за цим посиланням власноруч.

## Навантажувальне тестування

Для навантажувального тестування використовується Locust, тому спочатку перед запуском тестів встановіть Python (версії 3.10 або новіше), а тоді й сам Locust через pip:

```bash
pip install locust
```

### Запуск тестів

Відкрийте термінал у кореневій папці проекту та перейдіть до папки з тестами:

```bash
cd load-test
```

Ви можете запустити один із двох сценаріїв тестування. Але перед цим запустіть в окремому терміналі сервер (з папки cmake-build-release).

Для проведення тестування консольного клієнта введіть:

```bash
locust -f locustfile.py
```

В свою чергу, для проведення тестування веб-клієнта треба ввести:

```bash
locust -f web_locustfile.py --host http://localhost:3000
```

Перед цим переконайтесь, що `proxy-server.js` також запущений.

Після запуску команди відкрийте у браузері адресу http://localhost:8089, введіть кількість користувачів і можете запускати тест.
